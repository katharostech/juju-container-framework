<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js rust">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>container - Lucky - A charming framework for Juju</title>
        

        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../../../favicon.png">
        <link rel="stylesheet" href="../../../css/variables.css">
        <link rel="stylesheet" href="../../../css/general.css">
        <link rel="stylesheet" href="../../../css/chrome.css">
        <link rel="stylesheet" href="../../../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../../../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../../../highlight.css">
        <link rel="stylesheet" href="../../../tomorrow-night.css">
        <link rel="stylesheet" href="../../../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../../../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "rust" : "rust";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div id="sidebar-scrollbox" class="sidebar-scrollbox">
                <ol class="chapter"><li class="expanded affix "><a href="../../../overview.html">Overview</a></li><li class="spacer"></li><li class="expanded "><a href="../../../design.html"><strong aria-hidden="true">1.</strong> Design</a></li><li class="expanded "><a href="../../../development.html"><strong aria-hidden="true">2.</strong> Development</a></li><li class="spacer"></li><li class="expanded "><a href="../../../cli/lucky.html"><strong aria-hidden="true">3.</strong> Lucky CLI</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/charm.html"><strong aria-hidden="true">3.1.</strong> charm</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/charm/build.html"><strong aria-hidden="true">3.1.1.</strong> build</a></li><li class="expanded "><a href="../../../cli/lucky/charm/create.html"><strong aria-hidden="true">3.1.2.</strong> create</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client.html"><strong aria-hidden="true">3.2.</strong> client</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/set-status.html"><strong aria-hidden="true">3.2.1.</strong> set-status</a></li><li class="expanded "><a href="../../../cli/lucky/client/kv.html"><strong aria-hidden="true">3.2.2.</strong> kv</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/kv/get.html"><strong aria-hidden="true">3.2.2.1.</strong> get</a></li><li class="expanded "><a href="../../../cli/lucky/client/kv/set.html"><strong aria-hidden="true">3.2.2.2.</strong> set</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/container.html" class="active"><strong aria-hidden="true">3.2.3.</strong> container</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/container/image.html"><strong aria-hidden="true">3.2.3.1.</strong> image</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/container/image/get.html"><strong aria-hidden="true">3.2.3.1.1.</strong> get</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/image/set.html"><strong aria-hidden="true">3.2.3.1.2.</strong> set</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/container/apply-updates.html"><strong aria-hidden="true">3.2.3.2.</strong> apply-updates</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/env.html"><strong aria-hidden="true">3.2.3.3.</strong> env</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/container/env/get.html"><strong aria-hidden="true">3.2.3.3.1.</strong> get</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/env/set.html"><strong aria-hidden="true">3.2.3.3.2.</strong> set</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/container/set-entrypoint.html"><strong aria-hidden="true">3.2.3.4.</strong> set-entrypoint</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/set-command.html"><strong aria-hidden="true">3.2.3.5.</strong> set-command</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/volume.html"><strong aria-hidden="true">3.2.3.6.</strong> volume</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/container/volume/remove.html"><strong aria-hidden="true">3.2.3.6.1.</strong> remove</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/volume/add.html"><strong aria-hidden="true">3.2.3.6.2.</strong> add</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/volume/get.html"><strong aria-hidden="true">3.2.3.6.3.</strong> get</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/container/delete.html"><strong aria-hidden="true">3.2.3.7.</strong> delete</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/port.html"><strong aria-hidden="true">3.2.3.8.</strong> port</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/container/port/add.html"><strong aria-hidden="true">3.2.3.8.1.</strong> add</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/port/remove.html"><strong aria-hidden="true">3.2.3.8.2.</strong> remove</a></li><li class="expanded "><a href="../../../cli/lucky/client/container/port/list.html"><strong aria-hidden="true">3.2.3.8.3.</strong> list</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/container/set-network.html"><strong aria-hidden="true">3.2.3.9.</strong> set-network</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/public-address.html"><strong aria-hidden="true">3.2.4.</strong> public-address</a></li><li class="expanded "><a href="../../../cli/lucky/client/private-address.html"><strong aria-hidden="true">3.2.5.</strong> private-address</a></li><li class="expanded "><a href="../../../cli/lucky/client/get-config.html"><strong aria-hidden="true">3.2.6.</strong> get-config</a></li><li class="expanded "><a href="../../../cli/lucky/client/port.html"><strong aria-hidden="true">3.2.7.</strong> port</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/port/open.html"><strong aria-hidden="true">3.2.7.1.</strong> open</a></li><li class="expanded "><a href="../../../cli/lucky/client/port/close.html"><strong aria-hidden="true">3.2.7.2.</strong> close</a></li><li class="expanded "><a href="../../../cli/lucky/client/port/get-opened.html"><strong aria-hidden="true">3.2.7.3.</strong> get-opened</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/relation.html"><strong aria-hidden="true">3.2.8.</strong> relation</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/relation/get.html"><strong aria-hidden="true">3.2.8.1.</strong> get</a></li><li class="expanded "><a href="../../../cli/lucky/client/relation/set.html"><strong aria-hidden="true">3.2.8.2.</strong> set</a></li><li class="expanded "><a href="../../../cli/lucky/client/relation/list-units.html"><strong aria-hidden="true">3.2.8.3.</strong> list-units</a></li><li class="expanded "><a href="../../../cli/lucky/client/relation/list-ids.html"><strong aria-hidden="true">3.2.8.4.</strong> list-ids</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/leader.html"><strong aria-hidden="true">3.2.9.</strong> leader</a></li><li><ol class="section"><li class="expanded "><a href="../../../cli/lucky/client/leader/get.html"><strong aria-hidden="true">3.2.9.1.</strong> get</a></li><li class="expanded "><a href="../../../cli/lucky/client/leader/set.html"><strong aria-hidden="true">3.2.9.2.</strong> set</a></li><li class="expanded "><a href="../../../cli/lucky/client/leader/is-leader.html"><strong aria-hidden="true">3.2.9.3.</strong> is-leader</a></li></ol></li><li class="expanded "><a href="../../../cli/lucky/client/random.html"><strong aria-hidden="true">3.2.10.</strong> random</a></li><li class="expanded "><a href="../../../cli/lucky/client/get-resource.html"><strong aria-hidden="true">3.2.11.</strong> get-resource</a></li></ol></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Lucky - A charming framework for Juju</h1>

                        <div class="right-buttons">
                            <a href="../../../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                            <a href="https://github.com/katharostech/lucky" title="Git repository" aria-label="Git repository">
                                <i id="git-repository-button" class="fa fa-github"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#lucky-container" id="lucky-container">Lucky Container</a></h1>
<p>Control your Lucky containers. </p>
<h2><a class="header" href="#usage" id="usage">Usage</a></h2>
<p><code>container [FLAGS] &lt;SUBCOMMAND&gt;</code></p>
<h3><a class="header" href="#subcommands" id="subcommands">Subcommands</a></h3>
<ul>
<li><a href="./container/image.html">image</a>: Get and set the Docker image</li>
<li><a href="./container/apply-updates.html">apply-updates</a>: Apply pending container configuration updates</li>
<li><a href="./container/env.html">env</a>: Get and set container environment variables</li>
<li><a href="./container/set-entrypoint.html">set-entrypoint</a>: Set the docker entrypoint</li>
<li><a href="./container/set-command.html">set-command</a>: Set the docker command</li>
<li><a href="./container/volume.html">volume</a>: Configure container volumes</li>
<li><a href="./container/delete.html">delete</a>: Delete the docker container</li>
<li><a href="./container/port.html">port</a>: Add and remove container port bindings</li>
<li><a href="./container/set-network.html">set-network</a>: Set the docker network</li>
</ul>
<h2><a class="header" href="#getting-started" id="getting-started">Getting Started</a></h2>
<p>The <code>lucky container</code> command provides an easy way to run and modify containers as a part of your charm. Most charms will only run one container, but you can run more if desired.</p>
<p>Lucky has the concept of a &quot;default&quot; container, which is the container that is assumed to be operated on by all of the <code>lucky container</code> subcommands. Other than the default contianer there can be any number of &quot;named&quot; containers. You can specify that a <code>lucky container</code> command should run on a specific named container with the <code>--container</code> or <code>-c</code> flags.</p>
<p>The first step to setting up a container is to set the container image:</p>
<pre><code class="language-bash">$ lucky container image set nginx:latest
# Or if you wanted a named container
$ lucky container image set --container frontend nginx:latest
</code></pre>
<p>You <strong>must</strong> specify the image tag or digest when setting the image. Unlike the Docker CLI, Lucky will not assume you mean to deploy the <code>latest</code> tag if you do not specify a tag. If you fail to specify a tag you will get a Docker 404 error in the charm log and the charm script will error.</p>
<p>Once you have set the image for the container, you can use the other <code>lucky container</code> subcommands to set different attributes of the container. You can add environment variables, port bindings, and more.</p>
<pre><code># Add a port binding
$ lucky container port add 80:80
# Add an environment variable
$ lucky container env set PASSWORD=topsecret
# Add a volume
$ lucky volume add my-data:/data
</code></pre>
<blockquote>
<p><strong>Note:</strong> Not every attribute of containers can be set yet. If you have a need for a container feature that isn't there yet, it is very easy to add new ones, please <a href="https://tree.taiga.io/project/zicklag-lucky/issues">create an issue</a> and we will look into it.</p>
</blockquote>
<h2><a class="header" href="#how-containers-are-run" id="how-containers-are-run">How Containers are Run</a></h2>
<p>It is important to understand that the changes to the container configuration made with the <code>lucky container</code> subcommands do <em>not</em> happen immediately. The changes are applied <strong>after</strong> the current charm script has exited. This allows the charm to make any desired changes to the config and to wait until it is done before making the updates to the container. Lucky is smart about when to apply the Docker updates: it will not do anything if the container configuration after running the script ends up the same as it was before running the script.</p>
<p>If you need to know that your container configuration changes have been applied <em>before</em> the script exits you can use the <code>lucky container apply-updates</code> command to force Lucky to apply the container config changes.</p>
<h2><a class="header" href="#re-deployment-and-persistent-data" id="re-deployment-and-persistent-data">Re-deployment and Persistent Data</a></h2>
<p>Whenever a container config update needs to be made, the existing container, if present, will be stopped and removed and a new container will be run with the desired configuration. This means any files changes made in the container will be lost if they are not persisted in a volume. See the <a href="./volume">volume</a> subcommand for more information on volumes.</p>
<h2><a class="header" href="#container-removal" id="container-removal">Container Removal</a></h2>
<p>All running containers will be automatically stopped and removed by Lucky when the charm is removed. You can manually delete a container in your charm logic with <code>lucky container delete</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../../../cli/lucky/client/kv/set.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../../../cli/lucky/client/container/image.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../../../cli/lucky/client/kv/set.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../../../cli/lucky/client/container/image.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        
        
        
        <script type="text/javascript">
            window.playpen_copyable = true;
        </script>
        

        

        
        <script src="../../../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../../../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../../../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
