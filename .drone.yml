---
kind: pipeline
name: book
  
steps:
  - name: test
    image: hrektts/mdbook
    commands:
      - cd docs/book
      - mdbook test

  - name: build
    image: hrektts/mdbook
    commands:
      - cd docs/book
      - mdbook build
    
  - name: publish
    image: plugins/gh-pages
    settings:
      pages_directory: docs/book/build
      username:
        from_secret: github_username
      password:
        from_secret: github_access_key
    when:
      event:
        - push
      branch:
        - master

trigger:
  branch:
    exclude:
      - feature/*